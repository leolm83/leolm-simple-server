# worker_processes recomendado é igual ao numero de CPU cores

worker_processes 1;
events {
    # numero de conexoes maximas estabelecidas por worker_processes
    # ou seja, se tivermos 2 worker_processes 
    # e eles aceitarem 1024 conexoes cada,
    # entao conseguiremos suportar até 2048 conexoes simultaneas
    worker_connections 1024;
}
http {
    # define os servidores que irao estar na upstream
    upstream simple_app_server {
        server app1:8081;
        server app2:8082;
        server app3:8083;

    }


    server {
        listen 8080;
        server_name localhost;
        location / {
            # proxy_pass <nome upstream>
            proxy_pass http://simple_app_server;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;

        }
    }
}